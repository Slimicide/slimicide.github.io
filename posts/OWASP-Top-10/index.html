<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="OWASP Top 10 - OWASP Juice Shop" /><meta property="og:locale" content="en" /><meta name="description" content="The Open Web Application Security Project (OWASP) is a nonprofit that works to improve the security of software online. Annually they release a list of the top 10 most common web application vulnerabilities to be mindful of both as a tester and as a developer. Familiarity with the vulnerabilities that make this list is a crucial part of being an effective bug hunter whether you are on a red-team assessment or chasing bug bounties." /><meta property="og:description" content="The Open Web Application Security Project (OWASP) is a nonprofit that works to improve the security of software online. Annually they release a list of the top 10 most common web application vulnerabilities to be mindful of both as a tester and as a developer. Familiarity with the vulnerabilities that make this list is a crucial part of being an effective bug hunter whether you are on a red-team assessment or chasing bug bounties." /><link rel="canonical" href="https://slimicide.github.io/posts/OWASP-Top-10/" /><meta property="og:url" content="https://slimicide.github.io/posts/OWASP-Top-10/" /><meta property="og:site_name" content="Slimicide" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-10T17:30:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="OWASP Top 10 - OWASP Juice Shop" /><meta name="twitter:site" content="@Slimicide_" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-10T17:30:00+00:00","datePublished":"2022-05-10T17:30:00+00:00","description":"The Open Web Application Security Project (OWASP) is a nonprofit that works to improve the security of software online. Annually they release a list of the top 10 most common web application vulnerabilities to be mindful of both as a tester and as a developer. Familiarity with the vulnerabilities that make this list is a crucial part of being an effective bug hunter whether you are on a red-team assessment or chasing bug bounties.","headline":"OWASP Top 10 - OWASP Juice Shop","mainEntityOfPage":{"@type":"WebPage","@id":"https://slimicide.github.io/posts/OWASP-Top-10/"},"url":"https://slimicide.github.io/posts/OWASP-Top-10/"}</script><title>OWASP Top 10 - OWASP Juice Shop | Slimicide</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Slimicide"><meta name="application-name" content="Slimicide"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /avatar.PNG " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Slimicide</a></div><div class="site-subtitle font-italic">Learning to break things responsibly. Writeups 'n Stuff.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/Slimicide" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Slimicide_" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','domain.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>OWASP Top 10 - OWASP Juice Shop</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>OWASP Top 10 - OWASP Juice Shop</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/Slimicide_">Slimicide</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1652203800" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-10 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1678 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><p>The Open Web Application Security Project (OWASP) is a nonprofit that works to improve the security of software online. Annually they release a list of the top 10 most common web application vulnerabilities to be mindful of both as a tester and as a developer. Familiarity with the vulnerabilities that make this list is a crucial part of being an effective bug hunter whether you are on a red-team assessment or chasing bug bounties.<br /></p><p>OWASP also maintain an open-source project called the <a href="https://github.com/juice-shop/juice-shop">OWASP Juice Shop</a> which is home to all of these common vulnerabilities and some extra both for training and demonstration purposes. Normally with web applications, I like to use Burp Suite, but in the spirit of OWASP, I’ll be following along with <a href="https://www.zaproxy.org/">OWASP Zap</a> which is their free and open source Burp Suite competitor.<br /></p><p>I’m going to go through each item on the <a href="https://owasp.org/www-project-top-ten/">OWASP Top Ten 2021</a> and try exploit the ones available to me on the OWASP Juice Shop.<br /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>OWASP Top 10 2021
-----------------
A01:2021 - Broken Access Control
A02:2021 - Cryptographic Failures (Formerly Sensitive Data Exposure)
A03:2021 - Injection
A04:2021 - Insecure Design
A05:2021 - Security Misconfiguration
A06:2021 - Vulnerable and Outdated Components
A07:2021 - Identification and Authentication Failures (Formerly Broken Authentication)
A08:2021 - Software and Data Integrity Failures
A09:2021 - Security Logging and Monitoring Failures
A10:2021 - Server-Side Request Forgery
</pre></table></code></div></div><hr /><h1 id="a012021---broken-access-control">A01:2021 - Broken Access Control</h1><p>Broken Access Control describes a vulnerability where a user is able to access or change resources they should not have permissions to be accessing or changing. For example, accessing another user’s basket in the OWASP Juice Shop.<br /></p><p>Firstly, we need to understand how we access our own basket before finding out if we can access someone else’s. Create an account with on the Juice Shop, put something in your basket and click on <code class="language-plaintext highlighter-rouge">Your Basket</code> in the top right.</p><p><img data-src="/assets/img/Other/OWASP-Top-10/js_basket.png" alt="Basket" title="My Basket" data-proofer-ignore> <em>My Basket</em></p><p>Everything is normal, I put the Fruit Press in my basket, I clicked my basket and here it is. Now we can go to our history tab in Zap or Burp to see the request that was sent to view my basket:<br /> <code class="language-plaintext highlighter-rouge">GET http://127.0.0.1:3000/rest/basket/6</code><br /> It looks like <code class="language-plaintext highlighter-rouge">6</code> must be my account ID. What would happen if we knocked that <code class="language-plaintext highlighter-rouge">6</code> down to a <code class="language-plaintext highlighter-rouge">5</code>? Would we get another user’s basket? To find out we can enable request interception in Zap and modify that ID to match <code class="language-plaintext highlighter-rouge">5</code> instead of our destined <code class="language-plaintext highlighter-rouge">6</code>.</p><p><img data-src="/assets/img/Other/OWASP-Top-10/js_modifyid.png" alt="ID=5" title="ID=5" data-proofer-ignore> <em>/basket/5</em></p><p>As you can see from the screenshot, I have modified the ID and we can send it on using the blue arrow underlined above.</p><p><img data-src="/assets/img/Other/OWASP-Top-10/js_newbasket.png" alt="Basket 5" title="Basket 5" data-proofer-ignore> <em>A01:2021 - Broken Access Control</em></p><p>There it is, we have successfully accessed another user’s basket.</p><hr /><h1 id="a022021---cryptographic-failures">A02:2021 - Cryptographic Failures</h1><p>Cryptographic Failures describes a vulnerability where secrets can be accessed by users as a result of weak cryptography. For example, encoding secrets instead of encrypting them or using weak hashing algorithms such as MD5. The Juice Shop doesn’t have a whole lot of challenges in relation to this topic so the one I have chosen to demonstrate is forging a coupon.<br /></p><p>In <code class="language-plaintext highlighter-rouge">/ftp</code>, there are two files of current interest: <code class="language-plaintext highlighter-rouge">coupons_2013.md.bak</code> and <code class="language-plaintext highlighter-rouge">package.json.bak</code>. Trying to access these files regularly will result in a 403, however you can access them by adding <code class="language-plaintext highlighter-rouge">%2500.md</code> to the end of the request which is simply just URL-encoded <code class="language-plaintext highlighter-rouge">%00</code>.<br /></p><p><code class="language-plaintext highlighter-rouge">coupons_2013.md.bak</code> contains:<br /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>n&lt;MibgC7sn
mNYS#gC7sn
o*IVigC7sn
k#pDlgC7sn
o*I]pgC7sn
n(XRvgC7sn
n(XLtgC7sn
k#*AfgC7sn
q:&lt;IqgC7sn
pEw8ogC7sn
pes[BgC7sn
l}6D$gC7ss
</pre></table></code></div></div><p>Which currently isn’t much good. Inside <code class="language-plaintext highlighter-rouge">package.json.bak</code> is a list of dependencies used by the Juice Shop, among them is a dependency called <code class="language-plaintext highlighter-rouge">z85</code> running version <code class="language-plaintext highlighter-rouge">0.0</code>. Searching for <code class="language-plaintext highlighter-rouge">z85</code> reveals that it is an encoding algorithm. Assuming the contents of <code class="language-plaintext highlighter-rouge">coupons_2013.md.bak</code> are encoded using <code class="language-plaintext highlighter-rouge">z85</code>, we can reverse the encoding to find out the contents. Downloading <a href="https://www.npmjs.com/package/z85-cli">this package</a>, we can successfully do this.<br /> <code class="language-plaintext highlighter-rouge">z85 --decode "n&lt;MibgC7sn"</code> returns <code class="language-plaintext highlighter-rouge">JAN13-10</code><br /> <code class="language-plaintext highlighter-rouge">z85 --decode "mNYS#gC7sn"</code> returns <code class="language-plaintext highlighter-rouge">FEB13-10</code><br /> We now know what format the coupons are issued in, now we can modify a valid coupon found at <a href="https://twitter.com/owasp_juiceshop/status/1520578742807977984">@owasp_juiceshop</a>. Writing this, the current valid coupon is <code class="language-plaintext highlighter-rouge">o*I]qga+mn</code>.<br /> <code class="language-plaintext highlighter-rouge">z85 --decode "o*I]qga+mn"</code> returns <code class="language-plaintext highlighter-rouge">MAY22-20</code><br /> We can now modify this to give us a much better discount:<br /> <code class="language-plaintext highlighter-rouge">z85 --encode "MAY22-90"</code> returns <code class="language-plaintext highlighter-rouge">o*I]qga+Hu</code><br /> This is now a forged, currently valid 90% off discount coupon.</p><p><img data-src="/assets/img/Other/OWASP-Top-10/js_90discount.png" alt="90% off" title="90% off" data-proofer-ignore> <em>A02:2021 - Cryptographic Failures</em></p><hr /><h1 id="a032021---injection">A03:2021 - Injection</h1><p>Injection describes a vulnerability where user-supplied data is not validated, filtered or sanitized by the application. One of the most common and devastating kinds of injection would be SQL Injection. SQL Injection is a vulnerability where that user-supplied data is included unsanitized in a SQL query. For example, when logging in to the Juice Shop, the server will take your email and password and throw it into a SQL query to find your account in the database.<br /> An example query might look like:<br /> <code class="language-plaintext highlighter-rouge">SELECT * FROM users WHERE email = 'slimicide@juice-shop.com' AND password = '123'</code><br /> In this instance, the email and password are user-supplied data. Since the query is unsanitized, we can simply cut the query short and bypass the need for a password. If we wanted to take over the admin account and we don’t have a password, we can simply submit our login email as <code class="language-plaintext highlighter-rouge">admin@juice-sh.op'--</code><br /></p><p><code class="language-plaintext highlighter-rouge">'</code> closes the query field and <code class="language-plaintext highlighter-rouge">--</code> is a comment in SQL. This results in the part of the query asking for a password to be commented out leaving the final query to look like:<br /> <code class="language-plaintext highlighter-rouge">SELECT * FROM users WHERE email = 'admin@juice-sh.op'</code>--’ AND password = ‘123’<br /></p><p>This of course, will return the admin user.</p><p><img data-src="/assets/img/Other/OWASP-Top-10/js_injection.png" alt="SQL Injection" title="SQL Injection" data-proofer-ignore> <em>SQL Injection</em></p><p><img data-src="/assets/img/Other/OWASP-Top-10/js_admin.png" alt="Admin" title="Admin" data-proofer-ignore> <em>A03:2021 - Injection</em></p><hr /><h1 id="a042021---insecure-design">A04:2021 - Insecure Design</h1><p>Insecure Design is a very broad category and one that is hard to define in terms of the Juice Shop. Insecure Design is more so a thought saying “Well that’s probably not a good idea” rather than a concrete definition of a vulnerability. For example, having the <code class="language-plaintext highlighter-rouge">/ftp</code> directory available on the Juice Shop from earlier definitely fits this description. It’s not a vulnerability in itself but relying on 403s to keep unauthorized parties out of sensitive documents probably isn’t secure design, especially when those documents aren’t required at all by the application and also because we can bypass the 403 with little to no effort.</p><hr /><h1 id="a052021---security-misconfiguration">A05:2021 - Security Misconfiguration</h1><p>Security Misconfiguration describes a vulnerability in which a web application has some controls inaccurately configured or left insecure. For example, applications with default credentials enabled or a file upload filter bypass. For our Juice Shop example, we have a challenge called <code class="language-plaintext highlighter-rouge">Deprecated Interface</code> where we are told we can use a B2B interface that was not properly shut down.<br /></p><p>In order to find remnants of old features, we can look to the site’s complaint page. They allow uploads of <code class="language-plaintext highlighter-rouge">.zip</code> and <code class="language-plaintext highlighter-rouge">.pdf</code> files. In <code class="language-plaintext highlighter-rouge">main.js</code> we can find the upload functionality:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="k">this</span><span class="p">.</span><span class="nx">uploader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">kt</span><span class="p">.</span><span class="nx">bA</span><span class="p">({</span>
            <span class="na">url</span><span class="p">:</span> <span class="dl">'</span><span class="s1">./file-upload</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">authToken</span><span class="p">:</span> <span class="s2">`Bearer </span><span class="p">${</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">token</span><span class="dl">'</span><span class="p">)</span> <span class="p">}</span><span class="s2">`</span><span class="p">,</span>
            <span class="na">allowedMimeType</span><span class="p">:</span> <span class="p">[</span>
              <span class="dl">'</span><span class="s1">application/pdf</span><span class="dl">'</span><span class="p">,</span>
              <span class="dl">'</span><span class="s1">application/xml</span><span class="dl">'</span><span class="p">,</span>
              <span class="dl">'</span><span class="s1">text/xml</span><span class="dl">'</span><span class="p">,</span>
              <span class="dl">'</span><span class="s1">application/zip</span><span class="dl">'</span><span class="p">,</span>
              <span class="dl">'</span><span class="s1">application/x-zip-compressed</span><span class="dl">'</span><span class="p">,</span>
              <span class="dl">'</span><span class="s1">multipart/x-zip</span><span class="dl">'</span>
            <span class="p">],</span>
            <span class="na">maxFileSize</span><span class="p">:</span> <span class="mi">100000</span>
          <span class="p">}),</span>
</pre></table></code></div></div><p>The upload dialogue box shows only <code class="language-plaintext highlighter-rouge">.pdf</code> and <code class="language-plaintext highlighter-rouge">.zip</code> are supported, however looking at <code class="language-plaintext highlighter-rouge">main.js</code>, <code class="language-plaintext highlighter-rouge">.xml</code> is also supported despite the dialogue box not showing it. We can make a quick harmless <code class="language-plaintext highlighter-rouge">.xml</code> file and upload it to <code class="language-plaintext highlighter-rouge">/#/complain</code></p><p><img data-src="/assets/img/Other/OWASP-Top-10/js_xml.png" alt="XML" title="XML" data-proofer-ignore> <em>A05:2021 - Security Misconfiguration</em></p><hr /><h1 id="a062021---vulnerable-and-outdated-components">A06:2021 - Vulnerable and Outdated Components</h1><p>Nothing ambiguous about this title. Out of date software has vulnerabilities, using it makes you vulnerable. We have a list of dependencies from earlier in <code class="language-plaintext highlighter-rouge">/ftp/package.json.bak%2500.md</code>. We can simply search for them in <a href="https://retirejs.github.io/retire.js/">Retire.js</a>.<br /></p><p><code class="language-plaintext highlighter-rouge">sanitize-html</code> &lt;= 1.4.3 does not recursively sanitize input, making it vulnerable to XSS.</p><hr /><h1 id="a072021---identification-and-authentication-failures">A07:2021 - Identification and Authentication Failures</h1><p>Identification and Authentication Failures describes a class of vulnerability involving weak authentication or poor session management. Examples include: weak passwords, session hijacking and insecure password recovery mechanisms. For the Juice Shop, we’re going to reset Bender’s password. The Juice Shop’s password recovery process involves security questions with knowledge-based answers that people other than the account holder could know. It’s probably safe to assume Bender is referencing the robot from Futurama. His security question is:<br /></p><p><code class="language-plaintext highlighter-rouge">Company you first work for as an adult?</code><br /></p><p>A quick Google search reveals the answer is <code class="language-plaintext highlighter-rouge">Stop'n'Drop</code> and we successfully reset Bender’s password. Had an email been sent to <code class="language-plaintext highlighter-rouge">bender@juice-sh.op</code> to reset his password, we would probably have a significantly tougher time.</p><p><img data-src="/assets/img/Other/OWASP-Top-10/js_bender.png" alt="Bender" title="Bender" data-proofer-ignore> <em>A07:2021 - Identification and Authentication Failures</em></p><hr /><h1 id="a082021---software-and-data-integrity-failures">A08:2021 - Software and Data Integrity Failures</h1><p>Software and Data Integrity Failures refers to a class of vulnerabilities that are introduced to a system through plugins, libraries or modules from untrusted sources. Insecure Deserialization is also included in there. As I have just found out, the <code class="language-plaintext highlighter-rouge">Insecure Deserialization</code> challenges aren’t available on the Juice Shop when running it in a Docker container like I am so I cannot demonstrate this one.</p><hr /><h1 id="a092021---security-logging-and-monitoring-failures">A09:2021 - Security Logging and Monitoring Failures</h1><p>Security Logging and Monitoring Failures refers to the failure of a web application to collect any meaningful logs about activity happening on the application. The Juice Shop’s logs are publicly exposed at <code class="language-plaintext highlighter-rouge">/support/logs</code> and we can take a look inside to see what information is being collected. These logs don’t reveal anything beyond successful requests to server resources. They collect the resource accessed and the user-agent. They don’t log important events such as unsuccessful/successful logins, active scanning or password resets.</p><hr /><h1 id="a102021---server-side-request-forgery">A10:2021 - Server-Side Request Forgery</h1><p>Server-Side Request Forgery is a vulnerability in which the server can be tricked into making web requests for you, typically to access resources only available to the server. SSRF is a personal favorite of mine and is incredibly annoying to pull off on the Juice Shop. Thankfully, I have a write-up of one of my favorite HackTheBox machines <code class="language-plaintext highlighter-rouge">Forge</code> listed <a href="https://slimicide.github.io/posts/HackTheBox-Forge/">here</a>. <code class="language-plaintext highlighter-rouge">Forge</code> required a lot of playing around with SSRF to complete the <code class="language-plaintext highlighter-rouge">User</code> section of the box and is a much more detailed look at the vulnerability than I could have done on the Juice Shop. That write-up is also home to the Mona Lisa of MS-Paint diagrams.</p><h1>:)</h1></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/other/'>Other</a>, <a href='/categories/owasp/'>OWASP</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/webapp/" class="post-tag no-text-decoration" >webapp</a> <a href="/tags/burpsuite/" class="post-tag no-text-decoration" >burpsuite</a> <a href="/tags/owasp/" class="post-tag no-text-decoration" >owasp</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=OWASP Top 10 - OWASP Juice Shop - Slimicide&amp;url=https://slimicide.github.io/posts/OWASP-Top-10/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=OWASP Top 10 - OWASP Juice Shop - Slimicide&amp;u=https://slimicide.github.io/posts/OWASP-Top-10/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://slimicide.github.io/posts/OWASP-Top-10/&amp;text=OWASP Top 10 - OWASP Juice Shop - Slimicide" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/HackTheBox-Templated/">HackTheBox - Templated</a><li><a href="/posts/HackTheBox-Forge/">HackTheBox - Forge</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/active-directory/">active_directory</a> <a class="post-tag" href="/tags/exploit/">exploit</a> <a class="post-tag" href="/tags/pwntools/">pwntools</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/bloodhound/">bloodhound</a> <a class="post-tag" href="/tags/buffer-overflow/">buffer-overflow</a> <a class="post-tag" href="/tags/evil-winrm/">evil-winrm</a> <a class="post-tag" href="/tags/ldap/">ldap</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/CVE-2022-27677/"><div class="card-body"> <em class="timeago small" data-ts="1676894400" > 2023-02-20 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CVE-2022-27677 - Low-hanging SYSTEM shells</h3><div class="text-muted small"><p> As an enthusiast for all things offensive security for the last almost two years, I decided it was high time I stopped reading about other people’s interesting CVEs and instead go and find my own. ...</p></div></div></a></div><div class="card"> <a href="/posts/Poison-Null-Byte-Forging-A-LIBC-Leak/"><div class="card-body"> <em class="timeago small" data-ts="1669377600" > 2022-11-25 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Poison Null Byte - Forging a LIBC Leak</h3><div class="text-muted small"><p> I’ve been doing a lot of work recently on learning the heap and the techniques leveraged to exploit it through HeapLAB by Max Kamper. Particularly the heap as it pertains to Linux with GLIBC. One...</p></div></div></a></div><div class="card"> <a href="/posts/ROPEmporium-Write4/"><div class="card-body"> <em class="timeago small" data-ts="1665489600" > 2022-10-11 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ROPEmporium - Write4</h3><div class="text-muted small"><p> For this second post about Binary Exploitation, I was originally going to do just one step up from the last one, but then I decided the act of pushing arguments onto the stack for use in a function...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/HackTheBox-Intelligence/" class="btn btn-outline-primary" prompt="Older"><p>HackTheBox - Intelligence</p></a> <a href="/posts/HackTheBox-Templated/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox - Templated</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/Slimicide_">Slimicide</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/active-directory/">active_directory</a> <a class="post-tag" href="/tags/exploit/">exploit</a> <a class="post-tag" href="/tags/pwntools/">pwntools</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/bloodhound/">bloodhound</a> <a class="post-tag" href="/tags/buffer-overflow/">buffer-overflow</a> <a class="post-tag" href="/tags/evil-winrm/">evil-winrm</a> <a class="post-tag" href="/tags/ldap/">ldap</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
